Fork from Wardz Diminish AddOn to fix the latest API changes.

I take no credit for this AddOn, just a temporary fix.
